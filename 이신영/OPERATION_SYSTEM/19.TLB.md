# TLB는 무엇인가요?

**TLB (Translation Lookaside Buffer)** 는 CPU 내부에 위치한 고속 캐시 메모리입니다. 가상 주소를 물리 주소로 변환하는 작업에서 페이지 테이블을 직접 조회하지 않고, 변환 정보를 빠르게 가져올 수 있도록 도와줍니다.  
주로 최근에 사용된 페이지의 변환 정보를 저장하며, 가상 메모리 관리 성능을 최적화합니다.


## TLB를 쓰면 왜 빨라지나요?

TLB를 사용하면 가상 주소를 물리 주소로 변환하는 속도가 빨라집니다. 

1. **페이지 테이블 접근 시간 단축**
   - 일반적으로 페이지 테이블 조회는 메모리 접근을 필요로 하며 상대적으로 느립니다.
   - TLB는 캐시 메모리이기 때문에 페이지 테이블을 조회하지 않아도 바로 변환 정보를 제공합니다.

2. **지역성(Locality) 활용** 
   - 대부분의 프로그램은 참조 지역성(Locality of Reference)을 따릅니다.
   - 최근 사용된 주소 변환 정보는 TLB에 저장되어 있으므로 반복적인 변환 요청을 빠르게 처리할 수 있습니다.

3. **MMU와의 협업** 
   - TLB는 MMU와 협력하여 주소 변환 속도를 극대화합니다.

## MMU가 무엇인가요?

**MMU (Memory Management Unit)**는 CPU와 메모리 사이에서 주소 변환을 담당하는 하드웨어 장치입니다. 

1. **가상 주소 → 물리 주소 변환**
   - 프로세스가 사용하는 가상 주소를 물리 메모리 주소로 변환합니다.

2. **TLB와 협력**  
   - MMU는 변환 정보를 TLB에서 먼저 확인하며, TLB에 해당 정보가 없을 경우 페이지 테이블을 조회하여 변환을 수행합니다.

3. **메모리 보호 기능 제공**
   - 각 페이지에 대해 읽기, 쓰기, 실행 권한을 확인하고 위반 시 예외(Page Fault)를 발생시킵니다.


## TLB와 MMU는 어디에 위치해 있나요?

1. **TLB**
   - CPU 내부에 위치하며, 일반적으로 MMU와 매우 가까운 곳에서 작동합니다.  
   - 일부 시스템에서는 TLB가 MMU의 일부로 통합되어 있습니다.

2. **MMU**
   - CPU와 메모리 사이에 위치하며, 주소 변환 및 메모리 보호를 담당하는 하드웨어입니다.  
   - 현대 CPU에서는 MMU가 CPU 내부에 통합된 경우가 많습니다.


## 코어가 여러 개라면, TLB는 어떻게 동기화할 수 있을까요?

프로세스가 공유 메모리를 사용할 때, 한 코어에서 페이지 테이블이 변경되면 다른 코어의 TLB도 이를 반영해야 합니다.

1. **TLB Shootdown**
   - 한 코어에서 페이지 테이블 엔트리가 수정되면, 다른 코어에 이 정보를 알립니다.
   - 각 코어는 변경된 엔트리에 해당하는 TLB 항목을 무효화합니다.

2. **TLB Flush**
   - 페이지 테이블 전역 변경 시, 모든 코어의 TLB를 완전히 비웁니다.
   - 성능이 저하될 수 있으므로 자주 수행되지 않도록 최적화가 필요합니다.

3. **Hardware Support**
   - 일부 최신 CPU는 하드웨어 레벨에서 TLB 동기화를 지원하여 성능 저하를 최소화합니다.


## TLB 관점에서, Context Switching 발생 시 어떤 변화가 발생하는지 설명해 주세요?

1. **TLB Invalidation**  
   - 프로세스가 전환되면, 이전 프로세스의 주소 변환 정보가 더 이상 유효하지 않습니다.
   - 따라서 대부분의 운영체제는 TLB를 비우거나 특정 엔트리를 무효화(TLB Flush)합니다.

2. **성능 저하**  
   - TLB가 비워진 상태에서 새 프로세스 실행 시, 페이지 테이블 조회가 증가하여 변환 속도가 느려질 수 있습니다.

3. **최적화 기술**
   - **Tagged TLB**  
     - 각 TLB 항목에 프로세스 ID(Tag)를 추가하여 여러 프로세스의 정보를 동시에 저장할 수 있습니다.
   - **ASID (Address Space Identifier)**  
     - 프로세스마다 고유한 식별자를 사용하여 TLB 무효화 없이 Context Switching을 지원합니다.
